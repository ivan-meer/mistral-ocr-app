# Руководство пользователя Mistral OCR App

Это руководство поможет вам эффективно использовать приложение Mistral OCR для преобразования PDF-документов в форматы Markdown и JSON.

## Содержание

1. [Быстрый старт](#быстрый-старт)
2. [Настройка приложения](#настройка-приложения)
3. [Работа с URL PDF-документов](#работа-с-url-pdf-документов)
4. [Форматы вывода](#форматы-вывода)
5. [API интерфейс](#api-интерфейс)
6. [Демо-режим](#демо-режим)
7. [Часто задаваемые вопросы](#часто-задаваемые-вопросы)

## Быстрый старт

1. Запустите приложение: `python app.py`
2. Откройте в браузере: http://localhost:5000
3. Введите URL PDF-документа
4. Выберите формат вывода (Markdown или JSON)
5. Нажмите "Process"
6. Просмотрите результаты и скачайте их при необходимости

## Настройка приложения

### Переменные окружения

Файл `.env` содержит настройки для приложения:

```
# Ваш API ключ Mistral AI
MISTRAL_API_KEY=your_mistral_api_key_here

# Использовать демо-режим OCR (без обращения к API)
USE_MOCK_OCR=true

# Настройки сервера
PORT=5000
DEBUG=True
```

### Объяснение настроек

- **MISTRAL_API_KEY**: Ваш API-ключ Mistral AI. Необходим для работы с реальным OCR API.
- **USE_MOCK_OCR**: Установите `true` для использования демо-режима без API-ключа, `false` для использования реального OCR.
- **PORT**: Порт, на котором будет запущен веб-сервер (по умолчанию 5000).
- **DEBUG**: Режим отладки, установите `True` для разработки, `False` для боевого окружения.

## Работа с URL PDF-документов

Приложение поддерживает различные типы URL-адресов PDF-документов:

### Google Drive

Для документов на Google Drive используйте ссылку общего доступа. Приложение автоматически преобразует её в прямую ссылку для скачивания.

1. Откройте файл в Google Drive
2. Нажмите "Поделиться" → "Копировать ссылку"
3. Вставьте ссылку в приложение

Пример: `https://drive.google.com/file/d/1jvbo4I8_KTKxANTsd8vJsD0bYmRl4xzd/view?usp=sharing`

### Dropbox

Для документов в Dropbox:

1. Откройте файл в Dropbox
2. Нажмите "Поделиться" → "Копировать ссылку"
3. Вставьте ссылку в приложение

Пример: `https://www.dropbox.com/s/abcdef123456/document.pdf?dl=0`

### Прямые URL

Вы также можете использовать прямые URL-адреса PDF-документов:

Пример: `https://example.com/documents/sample.pdf`

## Форматы вывода

### Markdown

Формат Markdown предоставляет структурированный текст с сохранением:
- Заголовков
- Форматирования (жирный, курсив)
- Списков
- Таблиц
- Изображений (в base64)

Этот формат удобен для чтения и дальнейшего использования в системах, поддерживающих Markdown (GitHub, Notion, и т.д.).

### JSON

Формат JSON предоставляет полную структуру данных OCR, включая:
- Метаданные документа
- Текст каждой страницы
- Позиционирование элементов
- Информацию об изображениях

Этот формат подходит для программной обработки и интеграции с другими системами.

## API интерфейс

Приложение предоставляет следующие API-эндпоинты:

### Markdown API

```
GET /api/markdown?url={PDF_url}
```

**Параметры:**
- `url`: URL-адрес PDF-документа для обработки

**Ответ:** Markdown-текст с MIME-типом `text/markdown`

**Пример запроса:**
```
curl -X GET "http://localhost:5000/api/markdown?url=https://example.com/document.pdf"
```

### JSON API

```
GET /api/json?url={PDF_url}
```

**Параметры:**
- `url`: URL-адрес PDF-документа для обработки

**Ответ:** JSON-объект с результатами OCR

**Пример запроса:**
```
curl -X GET "http://localhost:5000/api/json?url=https://example.com/document.pdf"
```

### Status API

```
GET /api/status
```

**Ответ:** JSON-объект с информацией о статусе API

**Пример запроса:**
```
curl -X GET "http://localhost:5000/api/status"
```

## Демо-режим

Демо-режим позволяет использовать приложение без доступа к API Mistral. Для включения демо-режима установите в файле `.env`:

```
USE_MOCK_OCR=true
```

В демо-режиме:
- Приложение не отправляет запросы к Mistral API
- Возвращаются фиксированные демонстрационные данные
- URL-адрес передается только для отображения в результатах

Этот режим полезен для:
- Тестирования интерфейса
- Демонстрации функциональности
- Разработки без использования API-квоты

## Часто задаваемые вопросы

### Почему возникает ошибка "401 Unauthorized"?

Ошибка "401 Unauthorized" обычно означает одно из следующего:
- Неправильный API-ключ Mistral
- API-ключ не имеет доступа к OCR функциональности
- Учетная запись не оплатила или не имеет квоты на использование OCR

Для решения проблемы:
1. Проверьте правильность API-ключа в файле `.env`
2. Убедитесь, что ваш аккаунт Mistral имеет доступ к OCR API
3. Временно включите демо-режим: `USE_MOCK_OCR=true`

### Как обрабатывать большие PDF-документы?

Для больших PDF-документов:
1. Убедитесь, что документ доступен по URL с хорошей скоростью загрузки
2. Учтите, что OCR API может иметь ограничения по размеру документа
3. Для очень больших документов рассмотрите возможность разделения на части

### Как улучшить качество распознавания?

Качество распознавания зависит от:
- Качества исходного PDF
- Типа содержимого (текст, изображения, таблицы)
- Возможностей OCR API

Рекомендации:
1. Используйте документы хорошего качества
2. По возможности используйте PDF с текстовым слоем
3. Для сложных документов рассмотрите применение специализированных инструментов предобработки

### Могу ли я использовать приложение без интернета?

Нет, приложение требует доступа в интернет для:
- Доступа к PDF по URL
- Взаимодействия с Mistral OCR API

Даже в демо-режиме веб-интерфейс требует подключения к локальному веб-серверу.

### Как обрабатывать локальные PDF-файлы?

Текущая версия работает только с PDF по URL. Для локальных файлов:
1. Загрузите файл в облачное хранилище (Google Drive, Dropbox)
2. Сделайте файл общедоступным
3. Используйте полученную ссылку в приложении

### Какие языки поддерживает OCR?

Mistral OCR API поддерживает большинство основных языков. Для детальной информации обратитесь к [документации Mistral OCR](https://docs.mistral.ai/capabilities/document).
